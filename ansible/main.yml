---
- hosts: all
  become: yes
  gather_facts: yes

  vars:
    - locales_present:
        - en_US.UTF-8
        - de_DE.UTF-8
    - locales_language_packs_present:
        - language-pack-en
        - language-pack-en-base
        - language-pack-de
        - language-pack-de-base
    - locales_default:
        lang: de_DE.UTF-8
        # language: de_DE.UTF-8

  roles:
    - { role: geerlingguy.nfs }
    - { role: geerlingguy.packer-debian }
    - { role: tersmitten.locales, tags: ['testing'] }
    - { role: gantsign.keyboard, keyboard_model: pc105, keyboard_layout: de, tags: ['testing'] }
    - { role: cmprescott.dnsmasq, dnsmasq_dns_interfaces: [], tags: ['testing'] }
    - { role: toopy.lxc-dev, tags: ['testing']}

  tasks:
    - name: "Install needed packages"
      apt:
        name: "{{ item }}"
        state: installed
      with_items:
        - git
        - build-essential
        - automake
        - wget
        - curl
        - vim
        - screen
        - lvm2
        - python3-pip
        - python3-virtualenv
        - libffi-dev
        - libssl-dev
        - cowsay
        - sshpass
        - python3-dev
        - yum
        - rpm
        - zypper
        - qemu-user-static

    - name: Create a stopped container
      lxc_container:
        name: "test-container-{{item}}"
        container_log: true
        template: "{{item}}"
        state: stopped
      with_items:
        - ubuntu
        - debian
        - alpine
        - centos
        - fedora
